<div class="industries-page">
  <div class="page-header">
    <h1>Industry Management</h1>
    <p>Manage industries and their information</p>
  </div>

  <div class="page-content">
    <!-- Search and Actions -->
    <div class="toolbar">
      <div class="search-section">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          placeholder="Search industries..."
          class="search-input"
          (keyup.enter)="onSearch()"
        />
        <button class="search-btn" (click)="onSearch()">Search</button>
      </div>
      <button class="add-btn" (click)="onAddIndustry()">Add Industry</button>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="loading" class="loading-spinner">
      <div class="spinner"></div>
      <p>Loading...</p>
    </div>

    <!-- Industries Table -->
    <div *ngIf="!loading" class="industries-table-container">
      <table class="industries-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Image</th>
            <th>Status</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let industry of industries" class="industry-row">
            <td>{{ industry.name }}</td>
            <td>{{ industry.description || 'No description' }}</td>
            <td>
              <img 
                *ngIf="industry.imageUrl" 
                [src]="industry.imageUrl" 
                [alt]="industry.name"
                class="industry-thumbnail"
              />
              <span *ngIf="!industry.imageUrl">No image</span>
            </td>
            <td>
              <span class="status-badge" [class]="getStatusClass(industry.isActive)">
                {{ getStatusDisplayName(industry.isActive) }}
              </span>
            </td>
            <td>{{ industry.createdAt | date:'short' }}</td>
            <td class="actions">
              <button class="edit-btn" (click)="onEditIndustry(industry)">Edit</button>
              <button class="delete-btn" (click)="onDeleteIndustry(industry)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Empty State -->
      <div *ngIf="industries.length === 0" class="empty-state">
        <p>No industries found</p>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!loading && totalPages > 1" class="pagination">
      <button 
        class="page-btn" 
        [disabled]="currentPage === 1"
        (click)="onPageChange(currentPage - 1)"
      >
        Previous
      </button>
      
      <button 
        *ngFor="let page of pages" 
        class="page-btn"
        [class.active]="page === currentPage"
        (click)="onPageChange(page)"
      >
        {{ page }}
      </button>
      
      <button 
        class="page-btn" 
        [disabled]="currentPage === totalPages"
        (click)="onPageChange(currentPage + 1)"
      >
        Next
      </button>
    </div>
  </div>
</div>

<!-- Industry Form Modal -->
<div class="modal-overlay" *ngIf="showIndustryForm" (click)="onCancelForm()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ editingIndustry ? 'Edit Industry' : 'Add New Industry' }}</h2>
      <button class="close-btn" (click)="onCancelForm()">&times;</button>
    </div>
    
    <div class="modal-scrollable">
      <div class="modal-body">
        <form [formGroup]="industryForm" (ngSubmit)="onSaveIndustry()">
        <div class="form-group">
          <label for="name">Name *</label>
          <input
            type="text"
            id="name"
            name="name"
            formControlName="name"
            required
            minlength="2"
            maxlength="255"
            class="form-control"
            [class.error]="industryForm.invalid && industryForm.touched"
            placeholder="Enter industry name"
          />
          <div class="error-message" *ngIf="industryForm.invalid && industryForm.touched">
            Name is required and must be at least 2 characters long.
          </div>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            id="description"
            name="description"
            formControlName="description"
            maxlength="1000"
            class="form-control"
            rows="4"
            placeholder="Enter industry description"
          ></textarea>
          <div class="form-help">
            {{ (industryForm.get('description')?.value || '').length }}/1000 characters
          </div>
        </div>

        <div class="form-group">
          <label for="imageUrl">Image URL</label>
          <input
            type="url"
            id="imageUrl"
            name="imageUrl"
            formControlName="imageUrl"
            class="form-control"
            placeholder="https://example.com/image.jpg"
          />
          <div class="form-help">
            Enter a valid URL for the industry image.
          </div>
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              name="isActive"
              formControlName="isActive"
            />
            <span class="checkmark"></span>
            Active
          </label>
          <div class="form-help">
            Uncheck to deactivate this industry.
          </div>
        </div>
        </form>
      </div>
    </div>
    
    <div class="modal-footer">
      <button 
        type="button" 
        class="btn btn-secondary" 
        (click)="onCancelForm()"
        [disabled]="loading"
      >
        Cancel
      </button>
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="onSaveIndustry()"
        [disabled]="industryForm.invalid || loading"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="loading"></i>
        {{ editingIndustry ? 'Update' : 'Create' }} Industry
      </button>
    </div>
  </div>
</div>