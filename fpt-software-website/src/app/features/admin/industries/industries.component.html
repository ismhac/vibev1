<div class="industries-management">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1>Industry Management</h1>
      <p>Manage industries and their information</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="onAddIndustry()" [disabled]="loading">
        <i class="fas fa-plus"></i>
        Add Industry
      </button>
    </div>
  </div>

  <!-- Search and Filters -->
  <div class="search-section">
    <div class="search-bar">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        placeholder="Search industries..."
        class="search-input"
        (keyup.enter)="onSearch()"
      />
      <button class="btn btn-secondary" (click)="onSearch()" [disabled]="loading">
        <i class="fas fa-search"></i>
        Search
      </button>
    </div>
  </div>

  <!-- Error Message -->
  <div class="error-message" *ngIf="error">
    <div class="alert alert-error">
      <i class="fas fa-exclamation-triangle"></i>
      {{ error }}
      <button class="close-btn" (click)="error = null">&times;</button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading && industries.length === 0">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Loading industries...</p>
    </div>
  </div>

  <!-- Industries Table -->
  <div class="table-container" *ngIf="!loading || industries.length > 0">
    <table class="industries-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Image</th>
          <th>Status</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let industry of industries" class="industry-row">
          <td class="industry-name">
            <strong>{{ industry.name }}</strong>
          </td>
          <td class="industry-description">
            <span *ngIf="industry.description; else noDescription">
              {{ industry.description | slice:0:100 }}{{ industry.description.length > 100 ? '...' : '' }}
            </span>
            <ng-template #noDescription>
              <span class="text-muted">No description</span>
            </ng-template>
          </td>
          <td class="industry-image">
            <img 
              *ngIf="industry.imageUrl; else noImage" 
              [src]="industry.imageUrl" 
              [alt]="industry.name"
              class="industry-thumbnail"
            />
            <ng-template #noImage>
              <span class="text-muted">No image</span>
            </ng-template>
          </td>
          <td class="industry-status">
            <span [class]="getStatusClass(industry.isActive)">
              {{ getStatusDisplayName(industry.isActive) }}
            </span>
          </td>
          <td class="industry-created">
            {{ industry.createdAt | date:'short' }}
          </td>
          <td class="industry-actions">
            <button 
              class="btn btn-sm btn-outline-primary" 
              (click)="onEditIndustry(industry)"
              [disabled]="loading"
              title="Edit industry"
            >
              <i class="fas fa-edit"></i>
            </button>
            <button 
              class="btn btn-sm btn-outline-danger" 
              (click)="onDeleteIndustry(industry)"
              [disabled]="loading"
              title="Delete industry"
            >
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="industries.length === 0 && !loading">
      <div class="empty-content">
        <i class="fas fa-building"></i>
        <h3>No Industries Found</h3>
        <p>Start by adding your first industry.</p>
        <button class="btn btn-primary" (click)="onAddIndustry()">
          <i class="fas fa-plus"></i>
          Add Industry
        </button>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="totalPages > 1">
    <div class="pagination-info">
      Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalIndustries) }} of {{ totalIndustries }} industries
    </div>
    <div class="pagination">
      <button 
        class="btn btn-sm btn-outline-secondary" 
        (click)="onPageChange(currentPage - 1)"
        [disabled]="currentPage === 1 || loading"
      >
        <i class="fas fa-chevron-left"></i>
        Previous
      </button>
      
      <div class="page-numbers">
        <button 
          *ngFor="let page of pages" 
          class="btn btn-sm"
          [class.btn-primary]="page === currentPage"
          [class.btn-outline-secondary]="page !== currentPage"
          (click)="onPageChange(page)"
          [disabled]="loading"
        >
          {{ page }}
        </button>
      </div>
      
      <button 
        class="btn btn-sm btn-outline-secondary" 
        (click)="onPageChange(currentPage + 1)"
        [disabled]="currentPage === totalPages || loading"
      >
        Next
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>

<!-- Industry Form Modal -->
<div class="modal-overlay" *ngIf="showIndustryForm" (click)="onCancelForm()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ editingIndustry ? 'Edit Industry' : 'Add New Industry' }}</h2>
      <button class="close-btn" (click)="onCancelForm()">&times;</button>
    </div>
    
    <div class="modal-body">
      <form [formGroup]="industryForm" (ngSubmit)="onSaveIndustry()">
        <div class="form-group">
          <label for="name">Name *</label>
          <input
            type="text"
            id="name"
            name="name"
            formControlName="name"
            required
            minlength="2"
            maxlength="255"
            class="form-control"
            [class.error]="industryForm.invalid && industryForm.touched"
            placeholder="Enter industry name"
          />
          <div class="error-message" *ngIf="industryForm.invalid && industryForm.touched">
            Name is required and must be at least 2 characters long.
          </div>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            id="description"
            name="description"
            formControlName="description"
            maxlength="1000"
            class="form-control"
            rows="4"
            placeholder="Enter industry description"
          ></textarea>
          <div class="form-help">
            {{ (industryForm.get('description')?.value || '').length }}/1000 characters
          </div>
        </div>

        <div class="form-group">
          <label for="imageUrl">Image URL</label>
          <input
            type="url"
            id="imageUrl"
            name="imageUrl"
            formControlName="imageUrl"
            class="form-control"
            placeholder="https://example.com/image.jpg"
          />
          <div class="form-help">
            Enter a valid URL for the industry image.
          </div>
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              name="isActive"
              formControlName="isActive"
            />
            <span class="checkmark"></span>
            Active
          </label>
          <div class="form-help">
            Uncheck to deactivate this industry.
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button 
        type="button" 
        class="btn btn-secondary" 
        (click)="onCancelForm()"
        [disabled]="loading"
      >
        Cancel
      </button>
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="onSaveIndustry()"
        [disabled]="industryForm.invalid || loading"
      >
        <i class="fas fa-spinner fa-spin" *ngIf="loading"></i>
        {{ editingIndustry ? 'Update' : 'Create' }} Industry
      </button>
    </div>
  </div>
</div>